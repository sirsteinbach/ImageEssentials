!function(d,e,t,a){"use strict";Foundation.libs["magellan-expedition"]={name:"magellan-expedition",version:"5.5.0",settings:{active_class:"active",threshold:0,destination_threshold:20,throttle_delay:30,fixed_top:0,offset_by_height:!0,duration:700,easing:"swing"},init:function(t,a,e){Foundation.inherit(this,"throttle"),this.bindings(a,e)},events:function(){var s=this,t=s.S,a=s.settings;s.set_expedition_position(),t(s.scope).off(".magellan").on("click.fndtn.magellan","["+s.add_namespace("data-magellan-arrival")+'] a[href^="#"]',function(t){t.preventDefault();var a=d(this).closest("["+s.attr_name()+"]"),e=a.data("magellan-expedition-init"),i=this.hash.split("#").join(""),n=d('a[name="'+i+'"]');0===n.length&&(n=d("#"+i));var o=n.offset().top-e.destination_threshold+1;e.offset_by_height&&(o-=a.outerHeight()),d("html, body").stop().animate({scrollTop:o},e.duration,e.easing,function(){history.pushState?history.pushState(null,null,"#"+i):location.hash="#"+i})}).on("scroll.fndtn.magellan",s.throttle(this.check_for_arrivals.bind(this),a.throttle_delay)),d(e).on("resize.fndtn.magellan",s.throttle(this.set_expedition_position.bind(this),a.throttle_delay))},check_for_arrivals:function(){this.update_arrivals(),this.update_expedition_positions()},set_expedition_position:function(){var l=this;d("["+this.attr_name()+"=fixed]",l.scope).each(function(t,a){var e,i,n=d(this),o=n.data("magellan-expedition-init"),s=n.attr("styles");n.attr("style",""),e=n.offset().top+o.threshold,i=parseInt(n.data("magellan-fixed-top")),isNaN(i)||(l.settings.fixed_top=i),n.data(l.data_attr("magellan-top-offset"),e),n.attr("style",s)})},update_expedition_positions:function(){var o=this,s=d(e).scrollTop();d("["+this.attr_name()+"=fixed]",o.scope).each(function(){var t=d(this),a=t.data("magellan-expedition-init"),e=t.attr("style"),i=t.data("magellan-top-offset");if(s+o.settings.fixed_top>=i){var n=t.prev("["+o.add_namespace("data-magellan-expedition-clone")+"]");0===n.length&&((n=t.clone()).removeAttr(o.attr_name()),n.attr(o.add_namespace("data-magellan-expedition-clone"),""),t.before(n)),t.css({position:"fixed",top:a.fixed_top}).addClass("fixed")}else t.prev("["+o.add_namespace("data-magellan-expedition-clone")+"]").remove(),t.attr("style",e).css("position","").css("top","").removeClass("fixed")})},update_arrivals:function(){var o=this,s=d(e).scrollTop();d("["+this.attr_name()+"]",o.scope).each(function(){var e=d(this),i=e.data(o.attr_name(!0)+"-init"),t=o.offsets(e,s),a=e.find("["+o.add_namespace("data-magellan-arrival")+"]"),n=!1;t.each(function(t,a){if(a.viewport_offset>=a.top_offset)return e.find("["+o.add_namespace("data-magellan-arrival")+"]").not(a.arrival).removeClass(i.active_class),a.arrival.addClass(i.active_class),n=!0}),n||a.removeClass(i.active_class)})},offsets:function(o,t){var s=this,l=o.data(s.attr_name(!0)+"-init"),r=t;return o.find("["+s.add_namespace("data-magellan-arrival")+"]").map(function(t,a){var e=d(this).data(s.data_attr("magellan-arrival")),i=d("["+s.add_namespace("data-magellan-destination")+"="+e+"]");if(0<i.length){var n=i.offset().top-l.destination_threshold;return l.offset_by_height&&(n-=o.outerHeight()),n=Math.floor(n),{destination:i,arrival:d(this),top_offset:n,viewport_offset:r}}}).sort(function(t,a){return t.top_offset<a.top_offset?-1:t.top_offset>a.top_offset?1:0})},data_attr:function(t){return 0<this.namespace.length?this.namespace+"-"+t:t},off:function(){this.S(this.scope).off(".magellan"),this.S(e).off(".magellan")},reflow:function(){d("["+this.add_namespace("data-magellan-expedition-clone")+"]",this.scope).remove()}}}(jQuery,window,window.document);